<div class="panel flex-col">

	<div class="flex flex-row mb-5 items-center cursor-pointer" hx-get="/device/{{.Device.Id}}/full">
		<img class="icon px-1" src="/model/{{.Device.Model}}/images/back-arrow.png">
		<span class="no-underline">Download</span>
	</div>

	<form action="/device/{{.Device.Id}}/download-image" method="GET">
		<div class="flex flex-col">
			<div class="flex flex-row mb-5">
				<label>
					Target:
					<select name="target" id="download-target">

						<!-- Populate target drop-down with
							supported device targets.
							Select the target if specified
							in DeployParams.
						-->
{{- range $key, $target := .Vars.targets }}
	{{- if eq $key $.Vars.target }}
						<option value="{{ $key }}" selected>{{ $target.FullName }}</option>
	{{- else }}
						<option value="{{ $key }}">{{ $target.FullName }}</option>
	{{- end }}
{{- end }}

					</select>
				</label>
			</div>

			<!-- Target-specific elements embedded here.  Will be
				updated if target drop-down selection changes.
				-->

			<div class="flex flex-col"
				hx-get="/device/{{.Device.Id}}/download-target"
				hx-trigger="load, change from:#download-target"
				hx-target="this"
				hx-swap="innerHTML"
				hx-vals='js:{target: document.getElementById(`download-target`).value}'>
			</div>

			<div class="flex flex-col mt-8">
				<div class="flex flex-row justify-end mt-8">
					<button class="btn" type="submit">Download</button>
				</div>
			</div>

		</div>
	</form>
</div>

<!-- Target-specific instructions embedded here.  Will be
	updated if target drop-down selection changes.
	-->

<div class="panel flex flex-col text-sm"
	hx-get="/device/{{.Device.Id}}/download-instructions"
	hx-trigger="load, change from:#download-target"
	hx-target="this"
	hx-swap="innerHTML"
	hx-vals='js:{target: document.getElementById(`download-target`).value}'>
</div>
