// Autogenerated from device-runner.tmpl

package main

import (
	"os"

	"github.com/merliot/thing2"
	"github.com/merliot/thing2/models"
)

func main() {
	os.Setenv("PORT", "{{.Vars.port}}")
	os.Setenv("USER", "{{.Vars.user}}")
	os.Setenv("PASSWD", "{{.Vars.passwd}}")
	os.Setenv("DIAL_URLS", "{{.Vars.dialurls}}")

	os.Setenv("DEVICES", `{
	"{{.Device.Id}}": {
		"Id": "{{.Device.Id}}",
		"Model": "{{.Device.Model}}",
		"Name": "{{.Device.Name}}",
		"Children": [],
		"DeployParams": "{{.Device.DeployParams}}"
	}
}`)
{{ if .Vars.progenitive }}
	thing2.Models = models.AllModels
{{- else }}
	thing2.Models = thing2.ModelMap{
		"{{.Device.Model}}": models.{{title .Device.Model}},
	}
{{- end }}

	thing2.Run()
}
